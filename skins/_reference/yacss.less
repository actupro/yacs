/**
 * Core styles generated by YACS
 *
 * This is a reference style sheet of YACS, and it may be automatically updated
 * on each new software release.
 *
 * By default thoses styles are compiled and merged with skin's specific rules,
 * preceded by knacss' styles.
 * Use yourskin/skin.php and initialize function, set NO_YACSS constant to false
 * if you don't what this to be included in your project.
 *
 * @author Alexis Raimbault
 * @reference
 * @license http://www.gnu.org/copyleft/lesser.txt GNU Lesser General Public License
 */

/////////////
// namespace prefix, defined by php before compilation
// default is "y-" but you can overide this in your skin.php
@yacs-namespace: @y-prefix;

// path to this sheet, used to declare ressources as background image
@path : rPath() + "skins/_reference/";

////////////
// constants
//

@color-link               : steelblue;
@color-shadower           : rgba(0,0,0,.3);
@color-enlighter          : rgba(255,255,150,.5);
@color-lesser             : #888;
@color-tabs-borders       : #c0c0c0;
@color-tabs               : ghostwhite;
@color-modal              : #FFF;
@color-nav-tabs           : lightyellow;


////////////////////// 
// MIXINs
//
// those are mixins used within this less script
// use 'x-' prefix as a convention


// to enlight a element while hovered, focused or active
.x-enlight {
    
    position : relative;
    
    &:hover,
    &:focus,
    &:active {
    
        // enlight this with a pseudo class
        // that will cover it with transparency stuff
        &::before {
            position: absolute;
            top:0;left:0;            // fit to parent
            height:100%;width:100%;  // fit to parent
            content: '';             // only a background
            background: @color-enlighter;
            pointer-events: none;   // allow to click thru it
            border-radius:inherit;  // fit to parent
        }
    }
}

/////////////
// Helper classes
//
// used by yacs for specific contents
//

// error -- report on abnormal conditions
.@{yacs-namespace}error {
    color: red;
}

// editable object
.@{yacs-namespace}editable:hover {
    background: @color-shadower;
}

// details info, for example bottom of page, or hint
.@{yacs-namespace}details {
    font-family: sans-serif;
    font-size: 0.8em;
    color: @color-lesser;
}

// a interactive command that is emphatized when hovered
.@{yacs-namespace}command {
    opacity: 0.7;

    &:hover {
        opacity:1;
    }
}

// a icon that is commonly used to open/close menu on tiny screen
// consisting of three horizontal bars, looking like a hamburger
// <label><span></span></label>
.@{yacs-namespace}hamburger {

    display:block;
    padding:5px;
    background : @color-link;
    cursor: pointer;
    margin:0;
    // size will be defined by another class, but something
    // about 40px is expected;

    // shape of the bars
    // we use pseudo class to form the first and last bar
    span, span::before, span::after {

        background: #ffffff none repeat scroll 0 0;
        content: "";
        display: block;
        position: relative;
        transition: all 200ms ease-in-out 0s;
    }

    // position and size
    span {
        top:13px;
        height: 3px;

        &::after {bottom: -5px;height:4px;}

        &::before {top: -8px;height:3px;}
    }
}

// not visible to ordinary browsers -- accessibility tweak
.@{yacs-namespace}away { 
	position: absolute;
	left: -999px;
	width: 990px;
}


////////////////
//
// Standard tags
//

a {color:@color-link;}
a:visited {color:lighten(@color-link,10%);}
a:hover {color:darken(@color-link,10%);cursor:pointer;}

////////////////
// Navigation tabs
//
// the main navigation of the website
// by defaut a horizontal menu at the top
// could be two-level drop menu so we use nested <ul>
// @see skins/pages.php
//


.@{yacs-namespace}tabs { 

    position:relative;  // for responsive menu icon
    min-height:38px;
    background:rgba(255,255,255,0.6);
    
    & > ul {
        list-style: none; // no bullets
        padding:0; // no indent

        // first level links
        & > li > a {
            text-decoration: none;
            display:block;
            padding : 0.2em 1em;
            font-size : 1.3em;
            min-height : 38px;  // finger touch friendly
            margin-bottom : 1px; // separation with siblings
            color:@color-link;
            background-color: @color-nav-tabs;
            // transition form current focus
            transition: background-color 500ms ease-in;
            transition: color 500ms ease-in;

            // react on hover, focus and active states
            .x-enlight();

            // emphatize current focus
            &.current {
                background-color:@color-link;
                color: #FFF;
            }
        }
    }
}

.@{yacs-namespace}dropmenu {
    max-height:0; // second level hidden by default;
    overflow: hidden;
    padding : 0 .2em;
    transition: max-height 1s ease-in; // drop visual effect
    
    ul {
        list-style: none;
        padding:0;
        
        li {
            .x-enlight();
        }
    }
}

.@{yacs-namespace}tabs li:hover{
    
        .@{yacs-namespace}dropmenu {
             max-height:999px;  // dropmenu will get it's natural height
        }
}

// tabs on big screen
// uses flexbox
@media (min-width: @medium-plus-screen){
    
    #header_panel {overflow: visible;} // ensure dropdown menu will be display
    
    .@{yacs-namespace}tabs { 
        
        overflow:visible;
        
        & > ul {
            display: flex;
            flex-wrap : wrap;

            & > li {
                position:relative;  // to position dropmenu
                border-bottom : 1px solid @color-tabs-borders;

                .@{yacs-namespace}dropmenu {
                    position:absolute;
                    top:98%;
                    z-index:200;
                    background-color: @color-nav-tabs;
                    width:200px;
                }
                
                &:hover .@{yacs-namespace}dropmenu{
                    border : 1px solid @color-tabs-borders;
                    border-top : none;
                    padding-bottom: .2em;
                    padding-top : .5em;
                }
            }
        }
    }
}

////////////////
// Edition tabs
//
// tabs layout used it almost all edition form
// @see Skin::build_tabs() in skin_skeleton.php
//
.@{yacs-namespace}tabs-bar {
    margin: 2em 0 1em 0;    // space arround tabs
    position : relative;    // to position menu icon

    // default shape of a tabs
    // as a blocks (tiny-screen)
    a {
        display : block;
        padding : .4em 1em;
        text-decoration : none;
        color:@color-link;
        background-color: @color-tabs;

        height:38px;
        margin-bottom : 2px; // separation between tabs
        
        // react on hover, focus and active states
        .x-enlight();
    }

    .@{yacs-namespace}tab-foreground {
        background-color:@color-link;
        color: #FFF;
        opacity:1;
    }
}

// requierement for a panel
.@{yacs-namespace}tabs-panels {
    padding: 2px 0;
    margin-top : 1em;
    min-height: 200px;
    overflow: none;
    position: relative;
}

.@{yacs-namespace}panel-foreground {
    display: block;
}

.@{yacs-namespace}panel-background {
    display: none;
}

// navigation links used in step by step mode
.@{yacs-namespace}step {
    display :inline-block;
}

.@{yacs-namespace}tabs-mini-toggle {
    display:block;
    position:absolute;
    top : 0px;
    right: 0px;
    height:38px;
    width:38px;
}

// special rules for large screens
// tabs as a flexbox
@media (min-width: @medium-plus-screen){

    .@{yacs-namespace}tabs-bar {
        display : flex;
        flex-wrap : wrap;
        align-items: flex-start;
        border-bottom: 1px solid @color-tabs-borders;

        a {
            // shape of a tab
            border : 1px solid @color-tabs-borders;
            border-bottom: none;
            border-radius : 10px 10px 0 0;
            margin-right: 1px;
            margin-bottom: 0;
            height:auto;
        }

        .@{yacs-namespace}tab-foreground {
            // signal current tab with a colored line
            background-image : linear-gradient(to right,currentColor, currentColor);
            background-repeat: no-repeat;
            background-size: 100% 3px;
            background-position: center bottom;

            // override colors from small screen mode
            color:@color-link;
            background-color:@color-tabs;
        }
    }

    // we don't need icon on large screen
    .@{yacs-namespace}tabs-mini-toggle {
        display:none;
    }

}

///////////
// images
//
// Most of the below is coming from Skin::build_image(),
//
// @see skins/skin_skeleton.php
//

// figures should not oversize their parent's width
figure {max-width: 100%;}

// an image in the middle of the page [image=xx, center]
.@{yacs-namespace}center-image {
    clear: both;
    text-align: center;
    margin: 8px 0 8px 0;
}

// an image floated to the left -- [image=xx, left]
.@{yacs-namespace}left-image {
    float: left;
    clear:left;
    margin: 8px 8px 8px 0;
}

// an image floated to the rift -- [image=xx, right]
.@{yacs-namespace}right-image {
    float: right;
    clear:right;
    margin: 8px 0 8px 8px;
}

// float thumbnails to align them
.@{yacs-namespace}thumbnail-image {
    float: left;
    margin-right: 8px;
}

// caption under image
.@{yacs-namespace}image-caption {
    padding: 6px;
    font-size: 0.9em;
}

// direct edition link,
// hidden by default
.@{yacs-namespace}image-edit {
    display:none;
    position:absolute;
    top:1px;
    left:3px;

}

.@{yacs-namespace}thumbnail-image,
.@{yacs-namespace}left-image,
.@{yacs-namespace}right-image,
.@{yacs-namespace}center-image,
.@{yacs-namespace}inline-image
{
    display:block;
    position:relative;
    text-align: center; // this center the image, if caption is larger

    // edition link visible while parent is hovered
    &:hover .@{yacs-namespace}image-edit {
        display:block;
    }
}

////////////
// Modal box
//
// this box display content over a standard page
// which still in the background
//

// the grey overlay that sits behind the modal box
#modal_panel {	
	position: fixed;
	top: 0;left: 0;right:0;height:0;
        z-index: 1999; /* just below #modal_centered */
	min-height: 100%;
	background: @color-shadower;
	
}

// the centered container
#modal_centered { 
	position: absolute;
	top: 30%;	// top and left will be adjusted dynamically through javascript
	left: 30%;
        z-index: 2000;
	background-color: @color-modal;
	box-shadow : 0 0 5px #333;
	margin: 0 auto;
	padding: 4px;	
}

// allow scrolling in the modal box
#modal_content {
    overflow-y : auto;
}

// buttons used by the box
#modal_content .boxButtons {
	margin-top: 0.5em;
	padding: 0.5em 0 0.3em 0;
	text-align: center;
}

// title of the modal box
#modal_content .boxTitle {
	margin-top: 0;
	padding-top: 0;
	text-align: center;
}

// closing anchor of the modal box
// at its top right corner
#modal_close {
    position : absolute;
    top: -22px;
    right: -20px;   
    
    background: @color-modal;
    font-weight: bold;
    font-size: 2em;
    
    padding : 0 10px;
    border-radius : 15px;
    box-shadow: 6px 1px 5px #777;
    
    cursor : pointer;
    text-decoration: none;
    
    &:before {
        content: "×";
    }
}

///////////////////////
// Aside boxes
//
// extra-box and navigation-box

.@{yacs-namespace}extra-box,
.@{yacs-namespace}navigation-box {
    
    ul {
        list-style: none;
        
        a {
            text-decoration: none;
        }
    }
    
}


///////////////////////
//
// Contextual menu
//
// display sections tree
//

#contextual_menu {
    
    // tiny font
    font-size: 10px;
    line-height: 14px;
    
    // class for top level
    .tree {
        margin: 0;
        padding: 0;
        
        // branches
        ul {
            background: url('@{path}tree/vertical.gif') repeat-y 0px 100%;
            padding : 0;
            
            // nodes
            li {
                padding-left: 14px;
                background: url('@{path}tree/node.gif') no-repeat top left;
                
                // last node
                &.last {
                    background-image: url('@{path}tree/last.gif');
                }
                
                // path to the current element
                &.open > a, &.current > a {
                    font-weight: bold;
                    font-style: italic;
                    padding-left: 16px;
                    background: transparent url('@{path}tree/open.gif') no-repeat top left;
                    text-decoration: none;
                }
                
                // other pathes, closed
                a.close, a.below {
                    padding-left: 16px;
                    background: transparent url('@{path}tree/close.gif') no-repeat top left;
                    text-decoration:none;
                }
                
            }
        }
    }
}

/////////////////////
//
// Page menu
//
// a set of buttons

.@{yacs-namespace}page-menu,
.@{yacs-namespace}menu-bar {
    
    display: flex;
    flex-wrap: wrap;
    line-height : 2em;
    
    a {
        box-shadow:inset 0px 1px 0px 0px #fff;
        background:linear-gradient( to bottom, #ededed 5%, #dfdfdf 100% );
        background-color:#ededed;
        border-top-left-radius:10px;
        border-bottom-right-radius:10px;
        border:1px solid #dcdcdc;
        color:#777;
        text-shadow:1px 1px 0px #fff;
        text-decoration: none;
        padding : 0 0.5em;
        margin : 0.1em 0.2em;
        
        &:hover {
            background: linear-gradient( to top, #ededed 5%, #dfdfdf 100% );
            background-color:#dfdfdf;
            color:#777;
            text-decoration: none;
        }
        
        &:visited {
          color:#777;  
        }
        
        &:active {
            position:relative;
            top : 1px;
        }
    }
    
    // sometime <a> is wrapped in a span
    span a {
        display : inline-block;
    }
}

///////////////
//
// Standard button
//

.@{yacs-namespace}button {

    height: 1.5rem;
    line-height: 3.5rem;
    vertical-align: middle;
    margin: 0.2em;
    background: @color-link;
    color: darken(@color-link, 30%);
    padding: 0.6em;
    box-shadow: inset 0px 1px 0px 0px lighten(@color-link,30%);
    text-shadow:1px 1px 0px lighten(@color-link,30%);
    text-decoration: none;
    
    &:visited,
    &:hover {
        color : darken(@color-link, 30%);
    }
    
    &:hover, &:active {
       background: lighten(@color-link,10%); 
    }
}

/////////////////
//
// Sidebox, within content
//
// 

.@{yacs-namespace}sidebar-box {
    float : right;
    overflow: hidden;
    background:@color-tabs;
    font-size: 1.1rem;
    padding: 0.5rem;
}

////////////////
//
// Folder box, unfold with javascript
//

.@{yacs-namespace}folder-box {
    margin : 0.2em 0;
}

.@{yacs-namespace}folder-header {
    display : block;
    background : @color-tabs-borders url("@{path}layouts/accordion_plus.png") no-repeat left center;
    padding-left : 20px;
    
    &.open {
        background-image : url("@{path}layouts/accordion_minus.png");
    }
}

.@{yacs-namespace}folder-body {
    border : 1px solid @color-tabs-borders;
    border-top : none;
    padding : 1em;
    display : none;
}

.open + .@{yacs-namespace}folder-body {
    display : block;
}